/* Generated by Nimrod Compiler v0.9.3 */
/*   (c) 2012 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: MacOSX, amd64, gcc */
/* Command for C compiler:
   gcc -c  -w -O3 -fno-strict-aliasing  -I/usr/src/extras/Nimrod/lib -o compiler/nimcache/modules.o compiler/nimcache/modules.c */
#define NIM_INTBITS 64
#include "nimbase.h"

#include <stdio.h>
typedef struct tsymseq135649 tsymseq135649;
typedef struct tsym135677 tsym135677;
typedef struct TGenericSeq TGenericSeq;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct tcell38449 tcell38449;
typedef struct tcellseq38465 tcellseq38465;
typedef struct tgcheap40416 tgcheap40416;
typedef struct tcellset38461 tcellset38461;
typedef struct tpagedesc38457 tpagedesc38457;
typedef struct tmemregion22010 tmemregion22010;
typedef struct tsmallchunk21243 tsmallchunk21243;
typedef struct tllchunk22004 tllchunk22004;
typedef struct tbigchunk21245 tbigchunk21245;
typedef struct tintset21218 tintset21218;
typedef struct ttrunk21214 ttrunk21214;
typedef struct tavlnode22008 tavlnode22008;
typedef struct tgcstat40414 tgcstat40414;
typedef struct TY425048 TY425048;
typedef struct tmoduleinmemory425010 tmoduleinmemory425010;
typedef struct TY135763 TY135763;
typedef struct tnode135647 tnode135647;
typedef struct tidobj131012 tidobj131012;
typedef struct TNimObject TNimObject;
typedef struct ttypeseq135679 ttypeseq135679;
typedef struct ttype135681 ttype135681;
typedef struct TY135771 TY135771;
typedef struct tinstantiation135667 tinstantiation135667;
typedef struct tscope135671 tscope135671;
typedef struct tstrtable135651 tstrtable135651;
typedef struct tident131018 tident131018;
typedef struct tlineinfo128308 tlineinfo128308;
typedef struct tloc135661 tloc135661;
typedef struct trope126007 trope126007;
typedef struct tlib135665 tlib135665;
typedef struct NimStringDesc NimStringDesc;
typedef struct TY94237 TY94237;
typedef struct trodreader213023 trodreader213023;
typedef struct tllstream182205 tllstream182205;
typedef struct TY71082 TY71082;
typedef struct TY343130 TY343130;
typedef struct tcgen343028 tcgen343028;
typedef struct tbasechunk21241 tbasechunk21241;
typedef struct tfreecell21233 tfreecell21233;
typedef struct tnodeseq135641 tnodeseq135641;
typedef struct tlistentry100011 tlistentry100011;
typedef struct tindex213021 tindex213021;
typedef struct tiitable142212 tiitable142212;
typedef struct tiipairseq142210 tiipairseq142210;
typedef struct tiipair142208 tiipair142208;
typedef struct tidtable135693 tidtable135693;
typedef struct tidpairseq135691 tidpairseq135691;
typedef struct tidpair135689 tidpair135689;
typedef struct tmemfile211204 tmemfile211204;
typedef struct tpasscontext224003 tpasscontext224003;
typedef struct tintset132035 tintset132035;
typedef struct ttrunk132031 ttrunk132031;
typedef struct ttrunkseq132033 ttrunkseq132033;
typedef struct tlinkedlist100017 tlinkedlist100017;
typedef struct tcproc343024 tcproc343024;
typedef struct tnodetable135705 tnodetable135705;
typedef struct tnodepairseq135703 tnodepairseq135703;
typedef struct tnodepair135701 tnodepair135701;
typedef struct TY343089 TY343089;
typedef struct tblock343022 tblock343022;
struct TGenericSeq {
NI len;
NI reserved;
};
typedef N_NIMCALL_PTR(void, TY891) (void* p, NI op);
struct TNimType {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY891 marker;
};
struct TNimNode {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct tcell38449 {
NI Refcount;
TNimType* Typ;
};
struct tcellseq38465 {
NI Len;
NI Cap;
tcell38449** D;
};
struct tcellset38461 {
NI Counter;
NI Max;
tpagedesc38457* Head;
tpagedesc38457** Data;
};
typedef tsmallchunk21243* TY22022[512];
typedef ttrunk21214* ttrunkbuckets21216[256];
struct tintset21218 {
ttrunkbuckets21216 Data;
};
struct tmemregion22010 {
NI Minlargeobj;
NI Maxlargeobj;
TY22022 Freesmallchunks;
tllchunk22004* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk21245* Freechunkslist;
tintset21218 Chunkstarts;
tavlnode22008* Root;
tavlnode22008* Deleted;
tavlnode22008* Last;
tavlnode22008* Freeavlnodes;
};
struct tgcstat40414 {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct tgcheap40416 {
void* Stackbottom;
NI Cyclethreshold;
tcellseq38465 Zct;
tcellseq38465 Decstack;
tcellset38461 Cycleroots;
tcellseq38465 Tempstack;
NI Recgclock;
tmemregion22010 Region;
tgcstat40414 Stat;
};
struct tmoduleinmemory425010 {
NF Compiledat;
NI32 Crc;
TY135763* Deps;
NU8 Needsrecompile;
NU8 Crcstatus;
};
struct TNimObject {
TNimType* m_type;
};
struct tidobj131012 {
  TNimObject Sup;
NI Id;
};
struct tstrtable135651 {
NI Counter;
tsymseq135649* Data;
};
struct tlineinfo128308 {
NI16 Line;
NI16 Col;
NI32 Fileindex;
};
struct tloc135661 {
NU8 K;
NU8 S;
NU8 Flags;
ttype135681* T;
trope126007* R;
trope126007* Heaproot;
NI A;
};
struct tsym135677 {
  tidobj131012 Sup;
NU8 Kind;
union {
struct {ttypeseq135679* Typeinstcache;
} S1;
struct {TY135771* Procinstcache;
tscope135671* Scope;
} S2;
struct {TY135771* Usedgenerics;
tstrtable135651 Tab;
} S3;
} kindU;
NU16 Magic;
ttype135681* Typ;
tident131018* Name;
tlineinfo128308 Info;
tsym135677* Owner;
NU32 Flags;
tnode135647* Ast;
NU32 Options;
NI Position;
NI Offset;
tloc135661 Loc;
tlib135665* Annex;
tnode135647* Constraint;
};
typedef NIM_CHAR TY611[100000001];
struct NimStringDesc {
  TGenericSeq Sup;
TY611 data;
};
struct TY94237 {
NimStringDesc* Field0;
NimStringDesc* Field1;
NimStringDesc* Field2;
};
struct tident131018 {
  tidobj131012 Sup;
NimStringDesc* S;
tident131018* Next;
NI H;
};
struct TY71082 {
NimStringDesc* Field0;
NI Field1;
};
typedef NI32 TY425268[1];
typedef NI TY21221[8];
struct tpagedesc38457 {
tpagedesc38457* Next;
NI Key;
TY21221 Bits;
};
struct tbasechunk21241 {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct tsmallchunk21243 {
  tbasechunk21241 Sup;
tsmallchunk21243* Next;
tsmallchunk21243* Prev;
tfreecell21233* Freelist;
NI Free;
NI Acc;
NF64 Data;
};
struct tllchunk22004 {
NI Size;
NI Acc;
tllchunk22004* Next;
};
struct tbigchunk21245 {
  tbasechunk21241 Sup;
tbigchunk21245* Next;
tbigchunk21245* Prev;
NI Align;
NF64 Data;
};
struct ttrunk21214 {
ttrunk21214* Next;
NI Key;
TY21221 Bits;
};
typedef tavlnode22008* TY22014[2];
struct tavlnode22008 {
TY22014 Link;
NI Key;
NI Upperbound;
NI Level;
};
struct tnode135647 {
ttype135681* Typ;
tlineinfo128308 Info;
NU8 Flags;
NU8 Kind;
union {
struct {NI64 Intval;
} S1;
struct {NF64 Floatval;
} S2;
struct {NimStringDesc* Strval;
} S3;
struct {tsym135677* Sym;
} S4;
struct {tident131018* Ident;
} S5;
struct {tnodeseq135641* Sons;
} S6;
} kindU;
NimStringDesc* Comment;
};
struct ttype135681 {
  tidobj131012 Sup;
NU8 Kind;
NU8 Callconv;
NU32 Flags;
ttypeseq135679* Sons;
tnode135647* N;
tsym135677* Destructor;
tsym135677* Owner;
tsym135677* Sym;
NI64 Size;
NI Align;
tloc135661 Loc;
};
struct tinstantiation135667 {
tsym135677* Sym;
ttypeseq135679* Concretetypes;
TY135763* Usedby;
};
struct tscope135671 {
NI Depthlevel;
tstrtable135651 Symbols;
tscope135671* Parent;
};
struct trope126007 {
  TNimObject Sup;
trope126007* Left;
trope126007* Right;
NI Length;
NimStringDesc* Data;
};
struct tlistentry100011 {
  TNimObject Sup;
tlistentry100011* Prev;
tlistentry100011* Next;
};
struct tlib135665 {
  tlistentry100011 Sup;
NU8 Kind;
NIM_BOOL Generated;
NIM_BOOL Isoverriden;
trope126007* Name;
tnode135647* Path;
};
struct tiipair142208 {
NI Key;
NI Val;
};
struct tiitable142212 {
NI Counter;
tiipairseq142210* Data;
};
struct tindex213021 {
NI Lastidxkey;
NI Lastidxval;
tiitable142212 Tab;
NimStringDesc* R;
NI Offset;
};
struct tidpair135689 {
tidobj131012* Key;
TNimObject* Val;
};
struct tidtable135693 {
NI Counter;
tidpairseq135691* Data;
};
struct tmemfile211204 {
void* Mem;
NI Size;
int Handle;
};
struct trodreader213023 {
  TNimObject Sup;
NI Pos;
NCSTRING S;
NU32 Options;
NU8 Reason;
TY135763* Moddeps;
TY135763* Files;
NI Dataidx;
NI Convertersidx;
NI Initidx;
NI Interfidx;
NI Compilerprocsidx;
NI Methodsidx;
NimStringDesc* Filename;
tindex213021 Index;
tindex213021 Imports;
NI Readerindex;
NI Line;
NI Moduleid;
tidtable135693 Syms;
tmemfile211204 Memfile;
tsymseq135649* Methods;
NIM_BOOL Inviewmode;
};
struct tllstream182205 {
  TNimObject Sup;
NU8 Kind;
FILE* F;
NimStringDesc* S;
NI Rd;
NI Wr;
NI Lineoffset;
};
struct tpasscontext224003 {
  TNimObject Sup;
NIM_BOOL Fromcache;
};
typedef trope126007* tcfilesections343012[18];
struct tintset132035 {
NI Counter;
NI Max;
ttrunk132031* Head;
ttrunkseq132033* Data;
};
struct tlinkedlist100017 {
tlistentry100011* Head;
tlistentry100011* Tail;
NI Counter;
};
struct tnodepair135701 {
NI H;
tnode135647* Key;
NI Val;
};
struct tnodetable135705 {
NI Counter;
tnodepairseq135703* Data;
};
typedef trope126007* TY343122[10];
struct tcgen343028 {
  tpasscontext224003 Sup;
tsym135677* Module;
NimStringDesc* Filename;
tcfilesections343012 S;
NIM_BOOL Preventstacktrace;
NIM_BOOL Usesthreadvars;
NIM_BOOL Framedeclared;
NIM_BOOL Isheaderfile;
NimStringDesc* Cfilename;
tidtable135693 Typecache;
tidtable135693 Forwtypecache;
tintset132035 Declaredthings;
tintset132035 Declaredprotos;
tlinkedlist100017 Headerfiles;
tintset132035 Typeinfomarker;
tcproc343024* Initproc;
tcproc343024* Preinitproc;
ttypeseq135679* Typestack;
tnodetable135705 Datacache;
tsymseq135649* Forwardedprocs;
NI Typenodes;
NI Nimtypes;
trope126007* Typenodesname;
trope126007* Nimtypesname;
NI Labels;
TY343122 Extensionloaders;
};
struct tfreecell21233 {
tfreecell21233* Next;
NI Zerofield;
};
struct ttrunk132031 {
ttrunk132031* Next;
NI Key;
TY21221 Bits;
};
typedef trope126007* tcprocsections343016[3];
struct tblock343022 {
NI Id;
trope126007* Label;
tcprocsections343016 Sections;
NIM_BOOL Isloop;
NI16 Nestedtrystmts;
NI16 Framelen;
};
struct tcproc343024 {
tsym135677* Prc;
NIM_BOOL Beforeretneeded;
NIM_BOOL Threadvaraccessed;
tnodeseq135641* Nestedtrystmts;
NI Inexceptblock;
NI Labels;
TY343089* Blocks;
NI Breakidx;
NU32 Options;
NI Maxframelen;
tcgen343028* Module;
NI Withinloop;
NI Gcframeid;
trope126007* Gcframetype;
};
struct tsymseq135649 {
  TGenericSeq Sup;
  tsym135677* data[SEQ_DECL_SIZE];
};
struct TY135763 {
  TGenericSeq Sup;
  NI32 data[SEQ_DECL_SIZE];
};
struct TY425048 {
  TGenericSeq Sup;
  tmoduleinmemory425010 data[SEQ_DECL_SIZE];
};
struct ttypeseq135679 {
  TGenericSeq Sup;
  ttype135681* data[SEQ_DECL_SIZE];
};
struct TY135771 {
  TGenericSeq Sup;
  tinstantiation135667* data[SEQ_DECL_SIZE];
};
struct TY343130 {
  TGenericSeq Sup;
  tcgen343028* data[SEQ_DECL_SIZE];
};
struct tnodeseq135641 {
  TGenericSeq Sup;
  tnode135647* data[SEQ_DECL_SIZE];
};
struct tiipairseq142210 {
  TGenericSeq Sup;
  tiipair142208 data[SEQ_DECL_SIZE];
};
struct tidpairseq135691 {
  TGenericSeq Sup;
  tidpair135689 data[SEQ_DECL_SIZE];
};
struct ttrunkseq132033 {
  TGenericSeq Sup;
  ttrunk132031* data[SEQ_DECL_SIZE];
};
struct tnodepairseq135703 {
  TGenericSeq Sup;
  tnodepair135701 data[SEQ_DECL_SIZE];
};
struct TY343089 {
  TGenericSeq Sup;
  tblock343022 data[SEQ_DECL_SIZE];
};
static N_INLINE(void, nimGCunrefNoCycle)(void* p);
static N_INLINE(tcell38449*, usrtocell_41843)(void* usr);
static N_INLINE(void, rtladdzct_43002)(tcell38449* c);
N_NOINLINE(void, addzct_41815)(tcellseq38465* s, tcell38449* c);
N_NIMCALL(void*, newSeqRC1)(TNimType* typ, NI len);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP942)(void* p, NI op);
N_NIMCALL(tnode135647*, parsefile_200030)(NI32 fileidx);
N_NIMCALL(TGenericSeq*, setLengthSeq)(TGenericSeq* seq, NI elemsize, NI newlen);
N_NIMCALL(void, adddep_425132)(tsym135677* x, NI32 dep);
N_NIMCALL(void, docrc_425121)(NI32 fileidx);
N_NIMCALL(NI32, crcfromfile_124029)(NimStringDesc* filename);
N_NIMCALL(NimStringDesc*, tofilename_129085)(NI32 fileidx);
N_NIMCALL(tsym135677*, compilemodule_425505)(NI32 fileidx, NU32 flags);
N_NIMCALL(tsym135677*, getmodule_425072)(NI32 fileidx);
N_NIMCALL(tsym135677*, newmodule_425409)(NI32 fileidx);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(tident131018*, getident_131448)(NimStringDesc* identifier);
N_NIMCALL(void, nossplitFile)(NimStringDesc* path, TY94237* Result);
static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src);
N_NIMCALL(NIM_BOOL, isnimrodidentifier_185257)(NimStringDesc* s);
N_NIMCALL(void, rawmessage_129518)(NU16 msg, NimStringDesc* arg);
N_NIMCALL(tlineinfo128308, newlineinfo_128768)(NI32 fileinfoidx, NI line, NI col);
N_NIMCALL(void, initstrtable_135931)(tstrtable135651* x);
N_NIMCALL(void, strtableadd_142078)(tstrtable135651* t, tsym135677* n);
N_NIMCALL(trodreader213023*, handlesymbolfile_213059)(tsym135677* module);
N_NIMCALL(void, internalerror_129699)(NimStringDesc* errmsg);
static N_INLINE(NI, getid_134402)(void);
N_NIMCALL(void, processmodule_224049)(tsym135677* module, tllstream182205* stream, trodreader213023* rd);
N_NIMCALL(NU8, checkdepmem_425323)(NI32 fileidx);
N_NIMCALL(NIM_BOOL, crcchanged_425096)(NI32 fileidx);
N_NIMCALL(void, resetmodule_425290)(NI32 fileidx);
static N_INLINE(void, asgnRef)(void** dest, void* src);
static N_INLINE(void, incref_43824)(tcell38449* c);
static N_INLINE(NIM_BOOL, canbecycleroot_41865)(tcell38449* c);
static N_INLINE(void, rtladdcycleroot_42436)(tcell38449* c);
N_NOINLINE(void, incl_39256)(tcellset38461* s, tcell38449* cell);
static N_INLINE(void, decref_43402)(tcell38449* c);
N_NIMCALL(void, resetsourcemap_302940)(NI32 fileidx);
N_NIMCALL(void, localerror_129673)(tlineinfo128308 info, NU16 msg, NimStringDesc* arg);
N_NIMCALL(NI32, fileinfoidx_128506)(NimStringDesc* filename);
N_NIMCALL(NimStringDesc*, HEX2F_94062)(NimStringDesc* head, NimStringDesc* tail);
N_NIMCALL(void, compilesystemmodule_425652)(void);
N_NIMCALL(void, safeadd_425161)(TY135763** x, NI32 y);
N_NIMCALL(void*, newSeq)(TNimType* typ, NI len);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(TGenericSeq*, incrSeq)(TGenericSeq* seq, NI elemsize);
N_NIMCALL(NimStringDesc*, HEX24_129777)(TY71082 x);
N_NIMCALL(NIM_BOOL, HEX3DHEX3D_425173)(TY135763* x, TY135763* y);
static N_INLINE(void*, seqtoptr_425183)(TY135763* x);
STRING_LITERAL(TMP1709, "handleSymbolFile should have set the module\'s ID", 48);
STRING_LITERAL(TMP1712, "compiler/modules.nim", 20);
NIM_CONST TY71082 TMP1711 = {((NimStringDesc*) &TMP1712),
44}
;
STRING_LITERAL(TMP3536, "system.nim", 10);
STRING_LITERAL(TMP4158, "stdin", 5);
tsymseq135649* gcompiledmodules_425047;
extern TNimType NTI135649; /* TSymSeq */
extern tgcheap40416 gch_40442;
TY425048* gmemcachedata_425068;
TNimType NTI425010; /* TModuleInMemory */
extern TNimType NTI125; /* float */
extern TNimType NTI124005; /* TCrc32 */
extern TNimType NTI135763; /* seq[int32] */
TNimType NTI425006; /* TNeedRecompile */
TNimType NTI425008; /* TCrcStatus */
TNimType NTI425048; /* seq[TModuleInMemory] */
tsym135677* stdinmodule_425676;
extern NU32 gglobaloptions_105108;
extern TNimType NTI135645; /* PSym */
extern TNimType NTI135677; /* TSym */
extern NU8 gcmd_105110;
extern NI gfrontendid_134005;
extern NF glastcmdtime_105120;
extern TY343130* gmodules_343150;
extern NimStringDesc* libpath_105190;
extern NI32 systemfileidx_128436;
extern tsym135677* systemmodule_218011;

static N_INLINE(tcell38449*, usrtocell_41843)(void* usr) {
	tcell38449* result;
	result = 0;
	result = ((tcell38449*) ((NI)((NU64)(((NI) (usr))) - (NU64)(((NI)sizeof(tcell38449))))));
	return result;
}

static N_INLINE(void, rtladdzct_43002)(tcell38449* c) {
	addzct_41815(&gch_40442.Zct, c);
}

static N_INLINE(void, nimGCunrefNoCycle)(void* p) {
	tcell38449* c;
	c = usrtocell_41843(p);
	{
		(*c).Refcount -= 8;
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		rtladdzct_43002(c);
	}
	LA3: ;
}
N_NIMCALL(void, TMP942)(void* p, NI op) {
	TY425048* a;
	NI LOC1;
	a = (TY425048*)p;
	for (LOC1 = 0; LOC1 < a->Sup.len; LOC1++) {
	nimGCvisit((void*)a->data[LOC1].Deps, op);
	}
}

N_NIMCALL(void, adddep_425132)(tsym135677* x, NI32 dep) {
	{
		if (!(gmemcachedata_425068->Sup.len <= ((NI) (dep)))) goto LA3;
		gmemcachedata_425068 = (TY425048*) setLengthSeq(&(gmemcachedata_425068)->Sup, sizeof(tmoduleinmemory425010), ((NI) ((NI32)(dep + ((NI32) 1)))));
	}
	LA3: ;
	safeadd_425161(&gmemcachedata_425068->data[(*x).Position].Deps, dep);
}

N_NIMCALL(void, docrc_425121)(NI32 fileidx) {
	{
		NimStringDesc* LOC5;
		if (!(gmemcachedata_425068->data[fileidx].Crcstatus == ((NU8) 0))) goto LA3;
		LOC5 = 0;
		LOC5 = tofilename_129085(fileidx);
		gmemcachedata_425068->data[fileidx].Crc = crcfromfile_124029(LOC5);
	}
	LA3: ;
}

N_NIMCALL(tnode135647*, includemodule_425609)(tsym135677* s, NI32 fileidx) {
	tnode135647* result;
	result = 0;
	result = parsefile_200030(fileidx);
	{
		if (!((gglobaloptions_105108 &(1<<((((NU8) 15))&31)))!=0)) goto LA3;
		{
			if (!(gmemcachedata_425068->Sup.len <= ((NI) (fileidx)))) goto LA7;
			gmemcachedata_425068 = (TY425048*) setLengthSeq(&(gmemcachedata_425068)->Sup, sizeof(tmoduleinmemory425010), ((NI) ((NI32)(fileidx + ((NI32) 1)))));
		}
		LA7: ;
		adddep_425132(s, fileidx);
		docrc_425121(fileidx);
	}
	LA3: ;
	return result;
}

N_NIMCALL(tsym135677*, getmodule_425072)(NI32 fileidx) {
	tsym135677* result;
	result = 0;
	{
		NIM_BOOL LOC3;
		LOC3 = (((NI32) 0) <= fileidx);
		if (!(LOC3)) goto LA4;
		LOC3 = (((NI) (fileidx)) < gcompiledmodules_425047->Sup.len);
		LA4: ;
		if (!LOC3) goto LA5;
		result = gcompiledmodules_425047->data[fileidx];
	}
	LA5: ;
	return result;
}

static N_INLINE(void, asgnRefNoCycle)(void** dest, void* src) {
	{
		tcell38449* c;
		if (!!((src == NIM_NIL))) goto LA3;
		c = usrtocell_41843(src);
		(*c).Refcount += 8;
	}
	LA3: ;
	{
		tcell38449* c;
		if (!!(((*dest) == NIM_NIL))) goto LA7;
		c = usrtocell_41843((*dest));
		{
			(*c).Refcount -= 8;
			if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA11;
			rtladdzct_43002(c);
		}
		LA11: ;
	}
	LA7: ;
	(*dest) = src;
}

N_NIMCALL(tsym135677*, newmodule_425409)(NI32 fileidx) {
	tsym135677* result;
	NimStringDesc* filename;
	TY94237 LOC1;
	result = 0;
	result = (tsym135677*) newObj((&NTI135645), sizeof(tsym135677));
	(*result).Sup.Sup.m_type = (&NTI135677);
	(*result).Sup.Id = -1;
	(*result).Kind = ((NU8) 6);
	filename = tofilename_129085(fileidx);
	memset((void*)&LOC1, 0, sizeof(LOC1));
	nossplitFile(filename, &LOC1);
	asgnRefNoCycle((void**) &(*result).Name, getident_131448(LOC1.Field1));
	{
		NIM_BOOL LOC4;
		LOC4 = isnimrodidentifier_185257((*(*result).Name).S);
		if (!!(LOC4)) goto LA5;
		rawmessage_129518(((NU16) 21), (*(*result).Name).S);
	}
	LA5: ;
	asgnRefNoCycle((void**) &(*result).Owner, result);
	(*result).Info = newlineinfo_128768(fileidx, 1, 1);
	(*result).Position = ((NI) (fileidx));
	{
		if (!(gmemcachedata_425068->Sup.len <= ((NI) (fileidx)))) goto LA9;
		gmemcachedata_425068 = (TY425048*) setLengthSeq(&(gmemcachedata_425068)->Sup, sizeof(tmoduleinmemory425010), ((NI) ((NI32)(fileidx + ((NI32) 1)))));
	}
	LA9: ;
	{
		if (!(gcompiledmodules_425047->Sup.len <= ((NI) (fileidx)))) goto LA13;
		gcompiledmodules_425047 = (tsymseq135649*) setLengthSeq(&(gcompiledmodules_425047)->Sup, sizeof(tsym135677*), ((NI) ((NI32)(fileidx + ((NI32) 1)))));
	}
	LA13: ;
	asgnRefNoCycle((void**) &gcompiledmodules_425047->data[(*result).Position], result);
	(*result).Flags |=((NI32)(1)<<((((NU8) 0))%(sizeof(NI32)*8)));
	initstrtable_135931(&(*result).kindU.S3.Tab);
	strtableadd_142078(&(*result).kindU.S3.Tab, result);
	return result;
}

static N_INLINE(NI, getid_134402)(void) {
	NI result;
	result = 0;
	result = gfrontendid_134005;
	gfrontendid_134005 += 1;
	return result;
}

N_NIMCALL(NIM_BOOL, crcchanged_425096)(NI32 fileidx) {
	NIM_BOOL result;
	result = 0;
	{
		NIM_BOOL LOC3;
		NimStringDesc* LOC7;
		LOC3 = (((NI32) 0) <= fileidx);
		if (!(LOC3)) goto LA4;
		LOC3 = (((NI) (fileidx)) < gmemcachedata_425068->Sup.len);
		LA4: ;
		if (!!(LOC3)) goto LA5;
		LOC7 = 0;
		LOC7 = HEX24_129777(TMP1711);
		internalerror_129699(LOC7);
	}
	LA5: ;
	switch (gmemcachedata_425068->data[fileidx].Crcstatus) {
	case ((NU8) 2):
	{
		result = NIM_TRUE;
	}
	break;
	case ((NU8) 3):
	{
		result = NIM_FALSE;
	}
	break;
	case ((NU8) 1):
	{
		NI32 newcrc;
		NimStringDesc* LOC11;
		LOC11 = 0;
		LOC11 = tofilename_129085(fileidx);
		newcrc = crcfromfile_124029(LOC11);
		result = !((newcrc == gmemcachedata_425068->data[fileidx].Crc));
		gmemcachedata_425068->data[fileidx].Crc = newcrc;
		{
			if (!result) goto LA14;
			gmemcachedata_425068->data[fileidx].Crcstatus = ((NU8) 2);
		}
		goto LA12;
		LA14: ;
		{
			gmemcachedata_425068->data[fileidx].Crcstatus = ((NU8) 3);
		}
		LA12: ;
	}
	break;
	case ((NU8) 0):
	{
		NimStringDesc* LOC18;
		LOC18 = 0;
		LOC18 = tofilename_129085(fileidx);
		gmemcachedata_425068->data[fileidx].Crc = crcfromfile_124029(LOC18);
		result = NIM_TRUE;
		{
			if (!result) goto LA21;
			gmemcachedata_425068->data[fileidx].Crcstatus = ((NU8) 2);
		}
		goto LA19;
		LA21: ;
		{
			gmemcachedata_425068->data[fileidx].Crcstatus = ((NU8) 3);
		}
		LA19: ;
	}
	break;
	}
	return result;
}

static N_INLINE(NIM_BOOL, canbecycleroot_41865)(tcell38449* c) {
	NIM_BOOL result;
	result = 0;
	result = !((((*(*c).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
	return result;
}

static N_INLINE(void, rtladdcycleroot_42436)(tcell38449* c) {
	{
		if (!!((((NI) ((NI)((*c).Refcount & 3))) == 3))) goto LA3;
		(*c).Refcount = (NI)((NI)((*c).Refcount & -4) | 3);
		incl_39256(&gch_40442.Cycleroots, c);
	}
	LA3: ;
}

static N_INLINE(void, incref_43824)(tcell38449* c) {
	(*c).Refcount = (NI)((NU64)((*c).Refcount) + (NU64)(8));
	{
		NIM_BOOL LOC3;
		LOC3 = canbecycleroot_41865(c);
		if (!LOC3) goto LA4;
		rtladdcycleroot_42436(c);
	}
	LA4: ;
}

static N_INLINE(void, decref_43402)(tcell38449* c) {
	{
		(*c).Refcount -= 8;
		if (!((NU64)((*c).Refcount) < (NU64)(8))) goto LA3;
		rtladdzct_43002(c);
	}
	goto LA1;
	LA3: ;
	{
		NIM_BOOL LOC6;
		LOC6 = canbecycleroot_41865(c);
		if (!LOC6) goto LA7;
		rtladdcycleroot_42436(c);
	}
	goto LA1;
	LA7: ;
	LA1: ;
}

static N_INLINE(void, asgnRef)(void** dest, void* src) {
	{
		tcell38449* LOC5;
		if (!!((src == NIM_NIL))) goto LA3;
		LOC5 = usrtocell_41843(src);
		incref_43824(LOC5);
	}
	LA3: ;
	{
		tcell38449* LOC10;
		if (!!(((*dest) == NIM_NIL))) goto LA8;
		LOC10 = usrtocell_41843((*dest));
		decref_43402(LOC10);
	}
	LA8: ;
	(*dest) = src;
}

N_NIMCALL(void, resetmodule_425290)(NI32 fileidx) {
	gmemcachedata_425068->data[fileidx].Needsrecompile = ((NU8) 2);
	asgnRefNoCycle((void**) &gcompiledmodules_425047->data[fileidx], NIM_NIL);
	asgnRef((void**) &gmodules_343150->data[fileidx], NIM_NIL);
	resetsourcemap_302940(fileidx);
}

N_NIMCALL(NU8, checkdepmem_425323)(NI32 fileidx) {
	NU8 result;
	result = 0;
	{
		if (!!((gmemcachedata_425068->data[fileidx].Needsrecompile == ((NU8) 0)))) goto LA3;
		result = gmemcachedata_425068->data[fileidx].Needsrecompile;
		goto BeforeRet;
	}
	LA3: ;
	{
		NIM_BOOL LOC7;
		LOC7 = ((gglobaloptions_105108 &(1<<((((NU8) 1))&31)))!=0);
		if (LOC7) goto LA8;
		LOC7 = crcchanged_425096(fileidx);
		LA8: ;
		if (!LOC7) goto LA9;
		resetmodule_425290(fileidx);
		result = ((NU8) 2);
		goto BeforeRet;
	}
	LA9: ;
	{
		NIM_BOOL LOC13;
		NI32 dep_425391;
		TY135763* HEX3Atmp_425403;
		NI i_425405;
		LOC13 = HEX3DHEX3D_425173(gmemcachedata_425068->data[fileidx].Deps, NIM_NIL);
		if (!!(LOC13)) goto LA14;
		gmemcachedata_425068->data[fileidx].Needsrecompile = ((NU8) 3);
		dep_425391 = 0;
		HEX3Atmp_425403 = 0;
		HEX3Atmp_425403 = gmemcachedata_425068->data[fileidx].Deps;
		i_425405 = 0;
		while (1) {
			NU8 d;
			if (!(i_425405 < HEX3Atmp_425403->Sup.len)) goto LA16;
			dep_425391 = HEX3Atmp_425403->data[i_425405];
			d = checkdepmem_425323(dep_425391);
			{
				if (!((20 &(1<<((d)&7)))!=0)) goto LA19;
				resetmodule_425290(fileidx);
				result = ((NU8) 2);
				goto BeforeRet;
			}
			LA19: ;
			i_425405 += 1;
		} LA16: ;
	}
	LA14: ;
	gmemcachedata_425068->data[fileidx].Needsrecompile = ((NU8) 1);
	result = ((NU8) 1);
	goto BeforeRet;
	BeforeRet: ;
	return result;
}

N_NIMCALL(tsym135677*, compilemodule_425505)(NI32 fileidx, NU32 flags) {
	tsym135677* result;
	result = 0;
	result = getmodule_425072(fileidx);
	{
		trodreader213023* rd;
		if (!(result == NIM_NIL)) goto LA3;
		{
			if (!(gmemcachedata_425068->Sup.len <= ((NI) (fileidx)))) goto LA7;
			gmemcachedata_425068 = (TY425048*) setLengthSeq(&(gmemcachedata_425068)->Sup, sizeof(tmoduleinmemory425010), ((NI) ((NI32)(fileidx + ((NI32) 1)))));
		}
		LA7: ;
		gmemcachedata_425068->data[fileidx].Needsrecompile = ((NU8) 3);
		result = newmodule_425409(fileidx);
		rd = 0;
		(*result).Flags = ((*result).Flags | flags);
		{
			if (!((18438 &(1<<((gcmd_105110)&31)))!=0)) goto LA11;
			rd = handlesymbolfile_213059(result);
			{
				if (!((*result).Sup.Id < 0)) goto LA15;
				internalerror_129699(((NimStringDesc*) &TMP1709));
				goto BeforeRet;
			}
			LA15: ;
		}
		goto LA9;
		LA11: ;
		{
			(*result).Sup.Id = getid_134402();
		}
		LA9: ;
		processmodule_224049(result, NIM_NIL, rd);
		{
			if (!((gglobaloptions_105108 &(1<<((((NU8) 15))&31)))!=0)) goto LA20;
			gmemcachedata_425068->data[fileidx].Compiledat = glastcmdtime_105120;
			gmemcachedata_425068->data[fileidx].Needsrecompile = ((NU8) 4);
			docrc_425121(fileidx);
		}
		LA20: ;
	}
	goto LA1;
	LA3: ;
	{
		{
			NU8 LOC25;
			LOC25 = checkdepmem_425323(fileidx);
			if (!(LOC25 == ((NU8) 2))) goto LA26;
			result = compilemodule_425505(fileidx, flags);
		}
		goto LA23;
		LA26: ;
		{
			result = gcompiledmodules_425047->data[fileidx];
		}
		LA23: ;
	}
	LA1: ;
	BeforeRet: ;
	return result;
}

N_NIMCALL(tsym135677*, importmodule_425582)(tsym135677* s, NI32 fileidx) {
	tsym135677* result;
	result = 0;
	result = compilemodule_425505(fileidx, 0);
	{
		if (!((gglobaloptions_105108 &(1<<((((NU8) 15))&31)))!=0)) goto LA3;
		adddep_425132(s, fileidx);
	}
	LA3: ;
	{
		if (!(((*result).Flags &(1<<((((NU8) 13))&31)))!=0)) goto LA7;
		localerror_129673((*result).Info, ((NU16) 40), (*(*result).Name).S);
	}
	LA7: ;
	return result;
}

N_NIMCALL(void, compilesystemmodule_425652)(void) {
	{
		NimStringDesc* LOC5;
		tsym135677* LOC6;
		if (!(systemmodule_218011 == NIM_NIL)) goto LA3;
		LOC5 = 0;
		LOC5 = HEX2F_94062(libpath_105190, ((NimStringDesc*) &TMP3536));
		systemfileidx_128436 = fileinfoidx_128506(LOC5);
		LOC6 = 0;
		LOC6 = compilemodule_425505(systemfileidx_128436, 8192);
	}
	LA3: ;
}

N_NIMCALL(void, compileproject_425668)(NI32 projectfile) {
	NI32 systemfileidx;
	NimStringDesc* LOC1;
	LOC1 = 0;
	LOC1 = HEX2F_94062(libpath_105190, ((NimStringDesc*) &TMP3536));
	systemfileidx = fileinfoidx_128506(LOC1);
	{
		tsym135677* LOC6;
		if (!(projectfile == systemfileidx_128436)) goto LA4;
		LOC6 = 0;
		LOC6 = compilemodule_425505(projectfile, 12288);
	}
	goto LA2;
	LA4: ;
	{
		tsym135677* LOC8;
		compilesystemmodule_425652();
		LOC8 = 0;
		LOC8 = compilemodule_425505(projectfile, 4096);
	}
	LA2: ;
}

N_NIMCALL(tsym135677*, makestdinmodule_425679)(void) {
	tsym135677* result;
	result = 0;
	{
		NI32 LOC5;
		if (!(stdinmodule_425676 == NIM_NIL)) goto LA3;
		LOC5 = fileinfoidx_128506(((NimStringDesc*) &TMP4158));
		asgnRefNoCycle((void**) &stdinmodule_425676, newmodule_425409(LOC5));
		(*stdinmodule_425676).Sup.Id = getid_134402();
	}
	LA3: ;
	result = stdinmodule_425676;
	return result;
}

N_NIMCALL(void, resetallmodules_425295)(void) {
	NI i_425304;
	NI HEX3Atmp_425316;
	NI res_425318;
	i_425304 = 0;
	HEX3Atmp_425316 = 0;
	HEX3Atmp_425316 = (gcompiledmodules_425047->Sup.len-1);
	res_425318 = 0;
	while (1) {
		if (!(res_425318 <= HEX3Atmp_425316)) goto LA1;
		i_425304 = res_425318;
		{
			if (!!((gcompiledmodules_425047->data[i_425304] == NIM_NIL))) goto LA4;
			resetmodule_425290(((NI32) (i_425304)));
		}
		LA4: ;
		res_425318 += 1;
	} LA1: ;
}

N_NIMCALL(void, safeadd_425161)(TY135763** x, NI32 y) {
	{
		NIM_BOOL LOC3;
		TY425268 LOC6;
		LOC3 = HEX3DHEX3D_425173((*x), NIM_NIL);
		if (!LOC3) goto LA4;
		unsureAsgnRef((void**) &(*x), (TY135763*) newSeq((&NTI135763), 1));
		memset((void*)LOC6, 0, sizeof(LOC6));
		LOC6[0] = y;
		(*x)->data[0] = LOC6[0];
	}
	goto LA1;
	LA4: ;
	{
		(*x) = (TY135763*) incrSeq(&((*x))->Sup, sizeof(NI32));
		(*x)->data[(*x)->Sup.len-1] = y;
	}
	LA1: ;
}

N_NIMCALL(NIM_BOOL, HEX3DHEX3D_425173)(TY135763* x, TY135763* y) {
	NIM_BOOL result;
	result = 0;
	{
		void* LOC3;
		void* LOC4;
		LOC3 = seqtoptr_425183(x);
		LOC4 = seqtoptr_425183(y);
		if (!(LOC3 == LOC4)) goto LA5;
		result = NIM_TRUE;
	}
	goto LA1;
	LA5: ;
	{
		NIM_BOOL LOC8;
		void* LOC9;
		void* LOC11;
		LOC9 = seqtoptr_425183(x);
		LOC8 = (LOC9 == NIM_NIL);
		if (LOC8) goto LA10;
		LOC11 = seqtoptr_425183(y);
		LOC8 = (LOC11 == NIM_NIL);
		LA10: ;
		if (!LOC8) goto LA12;
		result = NIM_FALSE;
	}
	goto LA1;
	LA12: ;
	{
		NI i_425246;
		NI HEX3Atmp_425247;
		NI res_425249;
		if (!(x->Sup.len == y->Sup.len)) goto LA15;
		i_425246 = 0;
		HEX3Atmp_425247 = 0;
		HEX3Atmp_425247 = (NI64)(x->Sup.len - 1);
		res_425249 = 0;
		while (1) {
			if (!(res_425249 <= HEX3Atmp_425247)) goto LA17;
			i_425246 = res_425249;
			{
				if (!!((x->data[i_425246] == y->data[i_425246]))) goto LA20;
				result = NIM_FALSE;
				goto BeforeRet;
			}
			LA20: ;
			res_425249 += 1;
		} LA17: ;
		result = NIM_TRUE;
	}
	goto LA1;
	LA15: ;
	LA1: ;
	BeforeRet: ;
	return result;
}

static N_INLINE(void*, seqtoptr_425183)(TY135763* x) {
	void* result;
	result = 0;
	result = ((void*) (x));
	return result;
}
N_NOINLINE(void, modulesInit)(void) {
	if (gcompiledmodules_425047) nimGCunrefNoCycle(gcompiledmodules_425047);
	gcompiledmodules_425047 = (tsymseq135649*) newSeqRC1((&NTI135649), 0);
	if (gmemcachedata_425068) nimGCunrefNoCycle(gmemcachedata_425068);
	gmemcachedata_425068 = (TY425048*) newSeqRC1((&NTI425048), 0);
}

N_NOINLINE(void, modulesDatInit)(void) {
static TNimNode* TMP935[5];
static TNimNode* TMP936[5];
NI TMP938;
static char* NIM_CONST TMP937[5] = {
"Maybe", 
"No", 
"Yes", 
"Probing", 
"Recompiled"};
static TNimNode* TMP939[4];
NI TMP941;
static char* NIM_CONST TMP940[4] = {
"crcNotTaken", 
"crcCached", 
"crcHasChanged", 
"crcNotChanged"};
static TNimNode TMP933[17];
NTI425010.size = sizeof(tmoduleinmemory425010);
NTI425010.kind = 18;
NTI425010.base = 0;
NTI425010.flags = 2;
TMP935[0] = &TMP933[1];
TMP933[1].kind = 1;
TMP933[1].offset = offsetof(tmoduleinmemory425010, Compiledat);
TMP933[1].typ = (&NTI125);
TMP933[1].name = "compiledAt";
TMP935[1] = &TMP933[2];
TMP933[2].kind = 1;
TMP933[2].offset = offsetof(tmoduleinmemory425010, Crc);
TMP933[2].typ = (&NTI124005);
TMP933[2].name = "crc";
TMP935[2] = &TMP933[3];
TMP933[3].kind = 1;
TMP933[3].offset = offsetof(tmoduleinmemory425010, Deps);
TMP933[3].typ = (&NTI135763);
TMP933[3].name = "deps";
TMP935[3] = &TMP933[4];
NTI425006.size = sizeof(NU8);
NTI425006.kind = 14;
NTI425006.base = 0;
NTI425006.flags = 3;
for (TMP938 = 0; TMP938 < 5; TMP938++) {
TMP933[TMP938+5].kind = 1;
TMP933[TMP938+5].offset = TMP938;
TMP933[TMP938+5].name = TMP937[TMP938];
TMP936[TMP938] = &TMP933[TMP938+5];
}
TMP933[10].len = 5; TMP933[10].kind = 2; TMP933[10].sons = &TMP936[0];
NTI425006.node = &TMP933[10];
TMP933[4].kind = 1;
TMP933[4].offset = offsetof(tmoduleinmemory425010, Needsrecompile);
TMP933[4].typ = (&NTI425006);
TMP933[4].name = "needsRecompile";
TMP935[4] = &TMP933[11];
NTI425008.size = sizeof(NU8);
NTI425008.kind = 14;
NTI425008.base = 0;
NTI425008.flags = 3;
for (TMP941 = 0; TMP941 < 4; TMP941++) {
TMP933[TMP941+12].kind = 1;
TMP933[TMP941+12].offset = TMP941;
TMP933[TMP941+12].name = TMP940[TMP941];
TMP939[TMP941] = &TMP933[TMP941+12];
}
TMP933[16].len = 4; TMP933[16].kind = 2; TMP933[16].sons = &TMP939[0];
NTI425008.node = &TMP933[16];
TMP933[11].kind = 1;
TMP933[11].offset = offsetof(tmoduleinmemory425010, Crcstatus);
TMP933[11].typ = (&NTI425008);
TMP933[11].name = "crcStatus";
TMP933[0].len = 5; TMP933[0].kind = 2; TMP933[0].sons = &TMP935[0];
NTI425010.node = &TMP933[0];
NTI425048.size = sizeof(TY425048*);
NTI425048.kind = 24;
NTI425048.base = (&NTI425010);
NTI425048.flags = 2;
NTI425048.marker = TMP942;
}

